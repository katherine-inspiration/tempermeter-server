(this.webpackJsonptempermeter=this.webpackJsonptempermeter||[]).push([[0],{38:function(e,n,t){e.exports=t(52)},43:function(e,n,t){},44:function(e,n,t){},52:function(e,n,t){"use strict";t.r(n);var o=t(0),r=t.n(o),c=t(19),s=t.n(c),a=(t(43),t(5)),i=(t(44),t(3)),u=t(4);function l(){var e=Object(i.a)(["\n    background-color: white;\n    padding: 0px;\n    width: 100%;\n    display:block;\n    height: 100px;\n    box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.5);\n"]);return l=function(){return e},e}var d=u.a.header(l());function f(){var e=Object(i.a)(["\n    width: 150px;\n    height: 150px;\n    position:absolute;\n    top: -30px;\n    left: 20px;\n"]);return f=function(){return e},e}var h=u.a.img(f()),m=t(32);function b(){var e=Object(i.a)(["\n    font-size: 30px;\n    color: ",";\n    position: absolute;\n    top: 30px;\n    right: 40px;\n    \n    :hover{\n        cursor: pointer;\n    }\n"]);return b=function(){return e},e}var p=Object(u.a)(m.a)(b(),(function(e){return e.secondary?"#FD759C":"#2E753E"})),g=t(35);function E(){var e=Object(i.a)(["\n    width: 1000px;\n    margin: 20px auto;\n    background-color: white;\n    padding: 20px;\n    display: block;\n    text-align: center;\n    border: 1px pink solid;\n"]);return E=function(){return e},e}var O=u.a.section(E()),j=t(6),v=t(37),w=t(11);function y(){var e=Object(i.a)(["\n    padding: 18px 60px;\n    background-color: ",";\n    color: ",";\n    border: 1px "," solid;\n    display: inline-block;\n    font-size:20px;\n    text-decoration: none;\n    :hover{\n        cursor:pointer;\n    }\n    :active{\n        box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.5);\n    }\n"]);return y=function(){return e},e}var _=u.a.button(y(),(function(e){return e.disabled?"#a3a3a3":e.primary?"#2E753E":e.secondary?"#FD759C":"white"}),(function(e){return e.disabled?"black":e.primary||e.secondary?"white":"#2E753E"}),(function(e){return e.disabled?"black":e.secondary?"#FD759C":"#2E753E"}));function x(){var e=Object(i.a)(["\n    color: ",";\n    font-size: 30px;\n    font-weight: bold;\n\n"]);return x=function(){return e},e}var S=u.a.h1(x(),(function(e){return e.secondary?"#FD759C":"#2E753E"})),I=t(34);function k(){var e=Object(i.a)(["\n    \n    border:1px "," solid;\n    padding: 20px 40px;\n    font-size: 17px;\n    border-radius: 15px;\n    display: inline-block;\n    margin: 10px auto;\n    .date{\n        color: '#4d4d4d';\n        font-style: italic;\n    }\n    .result_name{\n        font-weight:bold;\n    }\n    :hover{\n        background-color: ",";\n        color: white;\n        cursor: pointer;\n    }\n"]);return k=function(){return e},e}var C=Object(u.a)((function(e){var n=Object(o.useState)(""),t=Object(a.a)(n,2),c=t[0],s=t[1];Object(o.useEffect)((function(){console.log("Props from Results History Item"),console.log(e);var n="";if(e.result.length>0){n+=e.result[0];var t,o=Object(I.a)(e.result);try{for(o.s();!(t=o.n()).done;){n+=" + "+t.value}}catch(r){o.e(r)}finally{o.f()}}s(n)}),[e]);var i=new Date(e.date).toLocaleTimeString("ru-RU",{month:"long",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",second:"2-digit"});return r.a.createElement("div",null,r.a.createElement("div",{className:e.className},r.a.createElement("span",{className:"date"},i),r.a.createElement("br",null),r.a.createElement("span",{className:"result_name"},c)))}))(k(),(function(e){return e.primary?"#2E753E":"#FD759C"}),(function(e){return e.primary?"#2E753E":"#FD759C"})),N=C;function q(){var e=Object(i.a)(["\n    border: 1px "," solid;\n    background-color: ",";\n    color: ",";\n    font-size: 18px;\n    border-radius: 15px;\n    padding: 20px;\n    \n"]);return q=function(){return e},e}var T=u.a.p(q(),(function(e){return e.secondary?"#FD759C":"#2E753E"}),(function(e){return e.primary?"#2E753E":e.secondary&&e.bold?"#FD759C":"white"}),(function(e){return e.primary||e.secondary&&e.bold?"white":"#4d4d4d"}));function D(){var e=Object(i.a)(["\n    width: 150px;\n    display: inline-block;\n    \n"]);return D=function(){return e},e}var F=Object(u.a)((function(e){return r.a.createElement("div",null,r.a.createElement("img",Object.assign({className:e.className},e,{src:"/images/preloader.svg"})))}))(D()),U=function(e){var n=Object(o.useState)(!1),t=Object(a.a)(n,2),c=t[0],s=t[1],i=Object(o.useState)([]),u=Object(a.a)(i,2),l=u[0],d=u[1],f=Object(o.useState)([]),h=Object(a.a)(f,2),m=h[0],b=h[1],p=Object(o.useState)(!1),g=Object(a.a)(p,2),E=g[0],O=g[1];return Object(o.useEffect)((function(){d(e.resultsHistory)}),[e.resultsHistory]),Object(o.useEffect)((function(){!function(){if(!E)s(!0),console.log("fetching /api/sessions/"+e.user_id),fetch("/api/sessions/"+e.user_id).then((function(e){return e.json()})).then((function(n){return n&&e.updateResultsHistory(n),console.log(n),s(!1),n})).catch((function(e){return console.log(e)}))}()}),[E]),Object(o.useEffect)((function(){console.log("Getting history items"),console.log(l),l.length>0?(b(l.map((function(e){return r.a.createElement(N,Object.assign({},e,{key:e.session_id}))}))),O(!0),console.log(m)):b(r.a.createElement(T,null,"\u0412\u0430\u0448\u0430 \u0438\u0441\u0442\u043e\u0440\u0438\u044f \u043f\u0443\u0441\u0442\u0430. \u0412\u044b \u0435\u0449\u0435 \u043d\u0438 \u0440\u0430\u0437\u0443 \u043d\u0435 \u043f\u0440\u043e\u0445\u043e\u0434\u0438\u043b\u0438 \u0442\u0435\u0441\u0442."))}),[l,e.resultsHistory]),r.a.createElement("div",null,c?r.a.createElement(F,null):m)};function P(){var e=Object(i.a)(["\n"]);return P=function(){return e},e}var H=Object(u.a)(U)(P()),A=t(36),R=[],z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,n=arguments.length>1?arguments[1]:void 0;Object(A.a)(e);switch(n.type){case"UPDATE-RESULTS-HISTORY":return n.newState;default:return e}},G=Object(w.b)((function(e){return{user_id:e.userInfo.user_id,resultsHistory:e.resultsHistory}}),(function(e){return{updateResultsHistory:function(n){e(function(e){return{type:"UPDATE-RESULTS-HISTORY",newState:e}}(n))}}}))(H),J=t(10),Q=function(e){return r.a.createElement("div",null,r.a.createElement(_,{primary:!0,as:J.b,to:"/test/",onClick:function(){fetch("/api/session/start/"+e.user_id).then((function(e){return console.log(e),e.json()})).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}},"\u041f\u0440\u043e\u0439\u0442\u0438 \u0442\u0435\u0441\u0442"),r.a.createElement(S,{secondary:!0},"\u0418\u0441\u0442\u043e\u0440\u0438\u044f"),r.a.createElement(G,{user_id:e.user_id}))},L={user_id:"1"},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:L,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"UPDATE-USER-INFO":return n.userInfo;default:return e}},W=function(e){return{type:"UPDATE-USER-INFO",userInfo:{user_id:e.user_id}}},Y=Object(w.b)((function(e){return Object(v.a)({},e.userInfo)}),(function(e){return{updateUserInfo:function(n){e(W(n))}}}))(Q),M=function(e){return r.a.createElement(T,{primary:!0},e.question_text)};function $(){var e=Object(i.a)(["\n    :hover{\n        cursor:pointer;\n    }\n    \n"]);return $=function(){return e},e}var K=function(e){var n=Object(o.useState)(!1),t=Object(a.a)(n,2),c=t[0],s=t[1];return Object(o.useEffect)((function(){s(e.chosen),console.log(e)}),[e.chosen]),r.a.createElement(T,{secondary:!0,bold:c,className:e.className,onClick:e.onClick},e.answer_text)},V=K=Object(u.a)(K)($());function X(){var e=Object(i.a)(["\n\n"]);return X=function(){return e},e}var Z=function(e){var n=Object(o.useState)([]),t=Object(a.a)(n,2),c=t[0],s=t[1],i=Object(o.useState)(!0),u=Object(a.a)(i,2),l=u[0],d=u[1],f=Object(o.useState)(null),h=Object(a.a)(f,2),m=h[0],b=h[1];Object(o.useEffect)((function(){p(e.question_id)}),[e.question_id]),Object(o.useEffect)((function(){b(c?c.map((function(n){return r.a.createElement(V,{answer_id:n.answer_id,answer_text:n.answer_text,onClick:function(t){e.answerChoiceHandler(n.answer_id),console.log(n.answer_id)},chosen:n.answer_id===+e.chosenAnswerId})})):null)}),[c,e.chosenAnswerId]);var p=function(n){return console.log("props"),console.log(e),console.log("Fetching answers for question "+n),n?fetch("/api/answers/"+n).then((function(e){return console.log(e),e.json()})).then((function(e){return console.log(e),s(e),d(!1),e})).catch((function(e){return console.log(e)})):[]};return r.a.createElement("div",null,l||e.isChosenFetching?r.a.createElement(F,null):m)},ee=Z=Object(u.a)(Z)(X());function ne(){var e=Object(i.a)(["\n    padding: 15px;\n    color: '#5e5e5e';\n    font-style:italic;\n    text-align: left;\n"]);return ne=function(){return e},e}var te=function(e){return r.a.createElement("div",{className:e.className},e.currentPage,"/",e.totalPages)},oe=te=Object(u.a)(te)(ne());function re(){var e=Object(i.a)(["\n    width: 100%;\n    height: 100%;\n    position: fixed;\n    background-color: rgba(33, 33, 33, 0.81);    \n    .wrapper{\n        background-color: white;\n        border: 1px black solid;\n        width: 800px;\n        margin: 200px auto;\n        padding: 20px;\n        text-align: center;\n        \n        .yes{\n            border: none;\n        }\n    }\n"]);return re=function(){return e},e}var ce=function(e){var n=Object(j.f)();return r.a.createElement("div",{className:e.className},r.a.createElement("div",{className:"wrapper"},r.a.createElement("p",null," \u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b, \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0437\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0442\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435?"),r.a.createElement(_,{secondary:!0,className:"no",onClick:function(){e.showFinishConfirmation(!1)}},"\u041d\u0435\u0442"),r.a.createElement(_,{primary:!0,className:"yes",onClick:function(){e.showFinishConfirmation(!1),fetch("/api/result/calculate/"+e.userId+"/"+e.sessionId).then((function(e){return e.json()})).then((function(t){console.log(t),n.push("/result/"+e.sessionId)})).catch((function(e){return console.log(e)}))}},"\u0414\u0430")))},se=ce=Object(u.a)(ce)(re()),ae=function(e){var n=Object(o.useState)(!1),t=Object(a.a)(n,2),c=(t[0],t[1],Object(o.useState)([])),s=Object(a.a)(c,2),i=s[0],u=s[1],l=Object(o.useState)(!1),d=Object(a.a)(l,2),f=d[0],h=d[1],m=Object(o.useState)(0),b=Object(a.a)(m,2),p=b[0],g=b[1],E=Object(o.useState)(null),O=Object(a.a)(E,2),j=O[0],v=O[1],w=Object(o.useState)(!1),y=Object(a.a)(w,2),x=y[0],S=y[1],I=Object(o.useState)(!1),k=Object(a.a)(I,2),C=k[0],N=k[1],q=function(e){console.log("client put body"),console.log(JSON.stringify(e)),fetch("/api/answer",{method:"PUT",body:JSON.stringify(e),headers:{"Content-Type":"application/json;charset=utf-8"}}).then((function(e){return e.json()})).then((function(e){return console.log(e),e})).catch((function(e){return console.log(e)}))},T=function(){e.showFinishConfirmation(!0)};Object(o.useEffect)((function(){e.setSessionId(e.session_id)}),[e.session_id]),Object(o.useEffect)((function(){S(0===p)}),[p]),Object(o.useEffect)((function(){h(!0),console.log("/api/session/"+e.user_id),fetch("/api/session/"+e.user_id).then((function(e){return e.json()})).then((function(n){return console.log(n),n&&e.updateSessionId(n.session_id),h(!1),n.session_id})).catch((function(e){return console.log(e)})),h(!0),console.log("Getting questions"),fetch("/api/questions").then((function(e){return console.log(e),e.json()})).then((function(n){return console.log("questions result"),console.log(n),n&&(e.updateQuestions(n),u(n)),h(!1),n})).catch((function(e){return console.log(e)}))}),[e]),Object(o.useEffect)((function(){i.length>0&&void 0!==p&&(console.log("Getting chosen answer"),console.log(i),console.log(p),function(n){if(N(!0),console.log("Trying to fetch chosen answers. Session id :"+e.sessionId+", chosen answer id: "+j+"question id: "+n),+e.sessionId&&!j)console.log("Fetching chosen answer"),fetch("/api/history/answers/"+e.sessionId+"/"+n).then((function(e){return e.json()})).then((function(e){return console.log("Got the chosen answer from history"),console.log(e),e.length>0&&v(e[0].answer_id),N(!1),e})).catch((function(e){console.log("Couldn't get the chosen answer from the server"),console.log(e)}))}(i[p].question_id))}),[e.sessionId,p,i]);var D=i.map((function(n){return r.a.createElement(M,{primary:!0,session_id:e.session_id,question_id:n.question_id,question_text:n.question_text,questions_picture:n.question_picture})}));return r.a.createElement("div",null,f?r.a.createElement(F,null):r.a.createElement("div",null,r.a.createElement(oe,{currentPage:p+1,totalPages:i.length}),D[p]),r.a.createElement(ee,{question_id:i.length>0?i[p].question_id:"",answerChoiceHandler:function(e){v(e)},chosenAnswerId:j,isChosenFetching:C}),f?null:r.a.createElement("div",null,r.a.createElement(_,{onClick:function(){i&&p>0&&(j&&q({session_id:e.session_id,answer_id:j,question_id:i[p].question_id}),g(p-1),v(null))},disabled:x},"\u041d\u0430\u0437\u0430\u0434"),r.a.createElement(_,{primary:p===i.length-1,onClick:function(){i&&(j&&q({session_id:e.session_id,answer_id:j,question_id:i[p].question_id}),p<i.length-1?(g(p+1),v(null)):T())}},p===i.length-1?"\u0417\u0430\u0432\u0435\u0440\u0448\u0438\u0442\u044c \u0442\u0435\u0441\u0442":"\u0412\u043f\u0435\u0440\u0435\u0434")))},ie={session_id:null},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"UPDATE-SESSION-ID":return{session_id:n.session_id};default:return e}},le=function(e){return{type:"UPDATE-SESSION-ID",session_id:e}},de=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"UPDATE-QUESTIONS":return n.questions;default:return e}},fe=function(e){return{type:"UPDATE-QUESTIONS",questions:e}},he=Object(w.b)((function(e){return{session_id:e.sessionInfo.session_id,user_id:e.userInfo.user_id}}),(function(e){return{updateSessionId:function(n){e(le(n))},updateQuestions:function(n){e(fe(n))}}}))(ae);function me(){var e=Object(i.a)(["\n    width:100%;\n"]);return me=function(){return e},e}Object(u.a)((function(e){return r.a.createElement("img",{className:e.className,src:"/images/Tempermeter_loader.svg"})}))(me());function be(){var e=Object(i.a)(["\n\n"]);return be=function(){return e},e}var pe=function(e){var n=Object(o.useState)(!1),t=Object(a.a)(n,2),c=t[0];t[1];return r.a.createElement("div",null,c?r.a.createElement(F,null):r.a.createElement("div",null,r.a.createElement(T,null,"Some result")))},ge=pe=Object(u.a)(pe)(be()),Ee=t(17),Oe=Object(Ee.b)({resultsHistory:z,userInfo:B,sessionInfo:ue,questions:de}),je=Object(Ee.c)(Oe);var ve=function(e){var n=Object(o.useState)(!1),t=Object(a.a)(n,2),c=t[0],s=t[1],i=Object(o.useState)(null),u=Object(a.a)(i,2),l=u[0],f=u[1];return r.a.createElement("div",null,c?r.a.createElement(se,{showFinishConfirmation:s,sessionId:l,userId:je.getState().userInfo.user_id}):null,r.a.createElement(d,null,r.a.createElement(h,{src:"images/Tempermeter-logo.svg",alt:"Tempermeter logo"}),r.a.createElement(p,{icon:g.a})),r.a.createElement(O,null,r.a.createElement(j.c,null,r.a.createElement(j.a,{exact:!0,path:"/",render:function(){return r.a.createElement(Y,null)}}),r.a.createElement(j.a,{exact:!0,path:"/test/",render:function(){return r.a.createElement(he,{showFinishConfirmation:s,setSessionId:f,sessionId:l})}}),r.a.createElement(j.a,{exact:!0,path:"/result/:session_id",render:function(e){return r.a.createElement(ge,{sessionId:e.match.params.session_id})}}),r.a.createElement(j.a,{render:function(){return r.a.createElement("div",null,"The page isn't found")}}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J.a,null,r.a.createElement(w.a,{store:je},r.a.createElement(ve,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.aa21e9ff.chunk.js.map